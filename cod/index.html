<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NEUROPSICOCENTRO - Gestão Global</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>

    <div class="container no-print">
        <header class="main-header">
            <h1>NEUROPSICOCENTRO</h1>
            <p>GESTÃO INTEGRADA DE ESTOQUE</p>
            
            <nav class="main-nav">
                <button class="nav-btn active" onclick="trocarAba(event, 'aba-estoque')">Inventário Global</button>
                <button class="nav-btn" onclick="trocarAba(event, 'aba-movimentacao')">Movimentar / Transferir</button>
                <button class="nav-btn" onclick="trocarAba(event, 'aba-historico')">Auditoria (Logs)</button>
                <div class="nav-divider"></div>
                <button class="nav-btn btn-export" onclick="exportarBackup()">Exportar</button>
                <button class="nav-btn btn-import" onclick="document.getElementById('input-importar').click()">Importar</button>
                <input type="file" id="input-importar" style="display: none;" accept=".json" onchange="importarBackup(event)">
                <button class="nav-btn btn-print" onclick="prepararImpressao()">Relatório</button>
            </nav>
        </header>

        <main id="aba-estoque" class="tab-content active">
            <section class="dashboard-grid">
                <div class="dash-card blue">
                    <span class="dash-title">Patrimônio Global</span>
                    <span id="dash-total-geral" class="dash-value">R$ 0,00</span>
                </div>
                <div class="dash-card red">
                    <span class="dash-title">Itens Zerados</span>
                    <span id="dash-itens-criticos" class="dash-value">0</span>
                </div>
                <div class="dash-card orange">
                    <span class="dash-title">Abaixo do Mínimo</span>
                    <span id="dash-itens-atencao" class="dash-value">0</span>
                </div>
            </section>

            <section class="card">
                <h3 id="titulo-form">Cadastro de Produto</h3>
                <form id="form-estoque">
                    <input type="hidden" id="edit-index">
                    <div class="grid-form">
                        <input type="text" id="item-sku" placeholder="SKU" readonly>
                        <select id="grupo" onchange="atualizarSubgrupos()" required>
                            <option value="">Grupo</option>
                            <option value="Imobilizado">Imobilizado</option>
                            <option value="Limpeza">Materiais de Limpeza</option>
                        </select>
                        <select id="subgrupo" required><option value="">Subgrupo</option></select>
                        <input type="text" id="item-nome" placeholder="Descrição do Item" required style="grid-column: span 2;">
                        <input type="number" id="item-preco" placeholder="Preço (R$)" step="0.01" min="0" required>
                    </div>

                    <div class="grid-unidades">
                        <div class="unidade-group">
                            <label>MATRIZ</label>
                            <input type="number" id="qtd-matriz" placeholder="Saldo" min="0" value="0">
                            <input type="number" id="min-matriz" placeholder="Mín" min="0" value="0">
                        </div>
                        <div class="unidade-group">
                            <label>LIFE</label>
                            <input type="number" id="qtd-life" placeholder="Saldo" min="0" value="0">
                            <input type="number" id="min-life" placeholder="Mín" min="0" value="0">
                        </div>
                        <div class="unidade-group">
                            <label>SUL</label>
                            <input type="number" id="qtd-sul" placeholder="Saldo" min="0" value="0">
                            <input type="number" id="min-sul" placeholder="Mín" min="0" value="0">
                        </div>
                    </div>

                    <div class="form-actions">
                        <button type="submit" id="btn-salvar" class="btn btn-save">Salvar no Catálogo</button>
                        <button type="button" class="btn btn-neutral" onclick="limparFormulario()">Limpar / Novo</button>
                    </div>
                </form>
            </section>

            <section class="card">
                <div class="table-header-controls">
                    <select id="filtro-unidade" onchange="renderizarTabela()" style="width: auto; margin-right: 10px;">
                        <option value="TODAS">Visão Consolidada</option>
                        <option value="MATRIZ">MATRIZ</option>
                        <option value="LIFE">LIFE</option>
                        <option value="SUL">SUL</option>
                    </select>
                    <input type="text" id="busca-estoque" placeholder="Pesquisar item..." onkeyup="renderizarTabela()" style="max-width: 300px;">
                </div>
                <div class="table-wrapper">
                    <table class="main-table">
                        <thead>
                            <tr>
                                <th>Unidade</th>
                                <th>SKU</th>
                                <th>Produto</th>
                                <th>Saldo</th>
                                <th>Mínimo</th>
                                <th>Subtotal</th>
                                <th>Ações</th>
                            </tr>
                        </thead>
                        <tbody id="corpo-tabela"></tbody>
                    </table>
                </div>
            </section>
        </main>

        <div id="aba-movimentacao" class="tab-content">
            <section class="card">
                <h3>Movimentação de Estoque</h3>
                <form id="form-movimentacao">
                    <div class="grid-form">
                        <select id="mov-unidade-origem" required>
                            <option value="">Origem...</option>
                            <option value="MATRIZ">MATRIZ</option>
                            <option value="LIFE">LIFE</option>
                            <option value="SUL">SUL</option>
                        </select>
                        <select id="mov-item" required><option value="">Item...</option></select>
                        <select id="mov-tipo" onchange="toggleDestino()" required>
                            <option value="entrada">Entrada (+)</option>
                            <option value="saida">Saída (-)</option>
                            <option value="transferencia">Transferência (⇄)</option>
                        </select>
                        <select id="mov-unidade-destino" style="display:none;">
                            <option value="">Destino...</option>
                            <option value="MATRIZ">MATRIZ</option>
                            <option value="LIFE">LIFE</option>
                            <option value="SUL">SUL</option>
                        </select>
                        <input type="number" id="mov-qtd" placeholder="Qtd" min="1" required>
                        <input type="text" id="mov-usuario" placeholder="Responsável" required>
                    </div>
                    <button type="submit" class="btn btn-action">Processar Movimentação</button>
                </form>
            </section>
        </div>

        <div id="aba-historico" class="tab-content">
            <section class="card">
                <div style="display: flex; justify-content: space-between; align-items: center;">
                    <h3>Registro de Auditoria</h3>
                    <button class="btn btn-danger" onclick="limparHistorico()">Limpar Logs</button>
                </div>
                <table class="main-table">
                    <thead>
                        <tr>
                            <th>Data/Hora</th>
                            <th>Operação</th>
                            <th>Item</th>
                            <th>Local</th>
                            <th>Usuário</th>
                        </tr>
                    </thead>
                    <tbody id="corpo-historico"></tbody>
                </table>
            </section>
        </div>
    </div>

    <div id="area-impressao" class="print-only"></div>
    <div id="toast-msg" class="toast"></div>

    <script src="script.js"></script>
</body>
</html>
